#!/usr/bin/env python3.3
# -*- coding: utf-8 -*-
#
# Config reader to read the configuration file
#
# Software is free software released under the "Modified BSD license"
#
# Copyright (c) 2015 	Pieter-Jan Moreels

# imports
import os
runPath = os.path.dirname(os.path.realpath(__file__))

import pymongo
import redis

import re
import datetime
import configparser


class Configuration():
    ConfigParser = configparser.ConfigParser()
    ConfigParser.read(os.path.join(runPath, "../configuration.ini"))
    default = {'mongoHost': 'localhost', 'mongoPort': 27017,
               'mongoDB': "cvedb"}

    @classmethod
    def readSetting(cls, section, item, default):
        result = default
        try:
            if type(default) == bool:
                result = cls.ConfigParser.getboolean(section, item)
            elif type(default) == int:
                result = cls.ConfigParser.getint(section, item)
            else:
                result = cls.ConfigParser.get(section, item)
        except:
            pass
        return result

    # Mongo
    @classmethod
    def getMongoConnection(cls):
        mongoHost = cls.readSetting("Mongo", "Host", cls.default['mongoHost'])
        mongoPort = cls.readSetting("Mongo", "Port", cls.default['mongoPort'])
        mongoDB = cls.readSetting("Mongo", "DB", cls.default['mongoDB'])
        connect = pymongo.MongoClient(mongoHost, mongoPort)
        return connect[mongoDB]
